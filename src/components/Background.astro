---
import fs from 'node:fs/promises';
import path from 'node:path';

const images = await fs.readdir(path.resolve('./public/assets/background'));
const _path = './assets/background/';
---

<div class="background" data-images={images.join('|||')} data-path={_path}></div>
<script>
  function loadBackground() {
    const element = document.querySelector('.background');
    const images = element.dataset.images.split('|||');
    const imageID = Math.floor(Math.random() * images.length);
    const image = images[imageID];
    const path = element.dataset.path;
    const fullPath = `${path}${image}`;
    const lGradient = 'linear-gradient(rgb(0,0,0,0.7), rgb(0,0,0,0.9))';

    element.style.background = `${lGradient}, url('${fullPath}')`;
    element.style.backgroundSize = 'cover';
    element.style.width = '100vw';
    element.style.height = '100vh';
    element.style.position = 'absolute';
    element.style.zIndex = '-1';
    element.style.top = '0';
  }
  loadBackground();
</script>
